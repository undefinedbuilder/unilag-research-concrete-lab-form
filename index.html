<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>UNILAG Research Mix Intake Form</title>
  <link rel="icon" type="image/png" href="unilag-logo.png" />

  <!-- IMPORTANT: Use your original stylesheet exactly -->
  <link rel="stylesheet" href="style.css" />

  <!-- jsPDF for PDF generation -->
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js" defer></script>
  <!-- Main front-end logic -->
  <script src="script.js" defer></script>
</head>

<body>
  <main class="container">
    <!-- HEADER -->
    <header class="header">
      <img src="unilag-logo.png" class="logo" alt="UNILAG Logo" />

      <div class="header-text">
        <div class="header-university"><strong>UNIVERSITY OF LAGOS</strong></div>
        <div class="header-dept"><strong>Department of Civil &amp; Environmental Engineering</strong></div>
        <div class="header-lab"><strong>CONCRETE LABORATORY</strong></div>
      </div>

      <p class="notice">
        <strong>NOTE:</strong> For research cube tests. Enter 0 or Nil for any
        component that is not applicable, where necessary.
      </p>
    </header>

    <!-- MAIN GRID -->
    <div class="main-grid">
      <!-- FORM -->
      <section class="card">
        <h3>Research Mix Intake Form</h3>

        <form id="mix-form">
          <!-- STUDENT & RESEARCH DETAILS -->
          <h4 class="section-title">Student &amp; Research Details</h4>

          <div class="grid two">
            <label>
              <span class="label-line">
                Student Name <span class="required-asterisk">*</span>
              </span>
              <input type="text" id="studentName" />
            </label>

            <label>
              <span class="label-line">
                Matriculation Number <span class="required-asterisk">*</span>
              </span>
              <input type="text" id="matricNumber" />
            </label>

            <label>
              <span class="label-line">
                Phone Number <span class="required-asterisk">*</span>
              </span>
              <input type="tel" id="studentPhone" />
            </label>

            <label>
              <span class="label-line">
                Programme <span class="required-asterisk">*</span>
              </span>
              <select id="programme">
                <option value="">Select programme…</option>
                <option value="Undergraduate (BSc)">Undergraduate (BSc)</option>
                <option value="Postgraduate (PGD)">Postgraduate (PGD)</option>
                <option value="Postgraduate (MSc)">Postgraduate (MSc)</option>
                <option value="Postgraduate (PhD)">Postgraduate (PhD)</option>
              </select>
            </label>

            <label>
              <span class="label-line">
                Supervisor's Name <span class="required-asterisk">*</span>
              </span>
              <input type="text" id="supervisorName" />
            </label>

            <label class="full-width">
              <span class="label-line">
                Project / Thesis Title <span class="required-asterisk">*</span>
              </span>
              <input
                type="text"
                id="thesisTitle"
                placeholder="e.g., Effect of SCMs on Compressive Strength"
              />
            </label>
          </div>

          <!-- MIX DESIGN OVERVIEW -->
          <h4 class="section-title">Mix Design Overview</h4>

          <div class="grid two">
            <label>
              <span class="label-line">
                Crushing Date <span class="required-asterisk">*</span>
              </span>
              <input type="date" id="crushDate" />
            </label>

            <label>
              <span class="label-line">
                Concrete Type <span class="required-asterisk">*</span>
              </span>
              <select id="concreteType">
                <option value="">-- Select --</option>
                <option>Normal strength</option>
                <option>High strength</option>
                <option>Self-compacting</option>
                <option>Fiber-reinforced</option>
                <option>Lightweight</option>
                <option>Other</option>
              </select>
            </label>

            <label id="concreteTypeOtherWrapper" style="display: none;">
              <span class="label-line">
                Specify Concrete Type <span class="required-asterisk">*</span>
              </span>
              <input type="text" id="concreteTypeOther" />
            </label>

            <label>
              <span class="label-line">
                Cement Type <span class="required-asterisk">*</span>
              </span>
              <select id="cementType">
                <option value="">-- Select --</option>
                <option>Portland Limestone Cement</option>
                <option>Ordinary Portland Cement</option>
                <option>Rapid Hardening Cement</option>
                <option>Blended</option>
                <option>Other</option>
              </select>
            </label>

            <label id="cementTypeOtherWrapper" style="display: none;">
              <span class="label-line">
                Specify Cement Type <span class="required-asterisk">*</span>
              </span>
              <input type="text" id="cementTypeOther" />
            </label>

            <label>
              <span class="label-line">
                Slump / Flow (mm) <span class="required-asterisk">*</span>
              </span>
              <input type="number" min="0" id="slump" />
            </label>

            <label>
              <span class="label-line">
                Age at Testing (days) <span class="required-asterisk">*</span>
              </span>
              <input type="number" min="1" id="ageDays" />
            </label>

            <label>
              <span class="label-line">
                Number of Cubes Submitted <span class="required-asterisk">*</span>
              </span>
              <input type="number" min="1" id="cubesCount" />
            </label>

            <label>
              <span class="label-line">
                Target Compressive Strength (MPa)
                <span class="required-asterisk">*</span>
              </span>
              <input type="number" min="0" step="0.1" id="targetStrength" />
            </label>

            <label>
              <span class="label-line">
                General Notes <span class="required-asterisk">*</span>
              </span>
              <textarea
                id="notes"
                rows="3"
                placeholder="e.g. Grade of Concrete"
              ></textarea>
            </label>
          </div>

          <!-- MIX INPUT MODE -->
          <h4 class="section-title">Mix Input Mode</h4>

          <div class="mix-mode-wrap" role="group" aria-label="Mix input mode">
            <div class="mix-mode-toggle">
              <label class="mix-mode-pill">
                <input type="radio" name="inputMode" value="kg" id="modeKg" checked />
                <span class="mix-mode-pill-title">Kg/m³</span>
                <span class="mix-mode-pill-sub">Enter material quantities per kg/m³</span>
              </label>

              <label class="mix-mode-pill">
                <input type="radio" name="inputMode" value="ratio" id="modeRatio" />
                <span class="mix-mode-pill-title"> Mix Ratios</span>
                <span class="mix-mode-pill-sub">Enter material quantities in mix ratios</span>
              </label>
            </div>
          </div>

          <!-- MATERIAL QUANTITIES (KG/M3) -->
          <h4 id="kgHeading" class="section-title">Material Quantities – Kg/m³</h4>

          <div id="kgInputs">
            <div class="grid two">
              <label>
                <span class="label-line">
                  Cement (kg/m³) <span class="required-asterisk">*</span>
                </span>
                <input type="number" min="0" step="0.1" id="cementContent" />
              </label>

              <label>
                <span class="label-line">
                  Water (kg/m³) <span class="required-asterisk">*</span>
                </span>
                <input type="number" min="0" step="0.1" id="waterContent" />
              </label>
            </div>

            <!-- Fine aggregate -->
            <h4 class="section-title">Fine Aggregate</h4>
            <div id="fine-kg-container" class="dynamic-group"></div>
            <button type="button" id="add-fine-kg-btn" class="btn-primary small">
              + add fine aggregate - kg/m³
            </button>

            <!-- Coarse aggregate -->
            <h4 class="section-title">Coarse Aggregate</h4>
            <div id="coarse-kg-container" class="dynamic-group"></div>
            <button type="button" id="add-coarse-kg-btn" class="btn-primary small">
              + add coarse aggregate - kg/m³
            </button>

            <!-- Hidden totals used for calculations & saving -->
            <input type="hidden" id="fineAgg" />
            <input type="hidden" id="coarseAgg" />
          </div>

          <!-- MATERIAL QUANTITIES (RATIOS) -->
          <h4 id="ratioHeading" class="section-title">Material Quantities – Mix Ratios (by Cement)</h4>

          <div id="ratioInputs" style="display: none;">
            <div class="grid two">
              <label>
                <span class="label-line">
                  Cement <span class="required-asterisk">*</span>
                </span>
                <input type="number" min="0" step="0.01" id="ratioCement" value="1" />
              </label>

              <label>
                <span class="label-line">
                  Water-Cement Ratio <span class="required-asterisk">*</span>
                </span>
                <input type="number" min="0" step="0.01" id="ratioWater" />
              </label>
            </div>

            <h4 class="section-title">Fine Aggregate</h4>
            <div id="fine-ratio-container" class="dynamic-group"></div>
            <button type="button" id="add-fine-ratio-btn" class="btn-primary small">
              + add fine aggregate - mix ratio
            </button>

            <h4 class="section-title">Coarse Aggregate</h4>
            <div id="coarse-ratio-container" class="dynamic-group"></div>
            <button type="button" id="add-coarse-ratio-btn" class="btn-primary small">
              + add coarse aggregate- mix ratio
            </button>

            <!-- Hidden totals used for calculations & saving -->
            <input type="hidden" id="ratioFine" />
            <input type="hidden" id="ratioCoarse" />
          </div>

          <!-- W/C & MIX RATIO -->
          <div id="wcratio-box" class="wc-box" style="display:none;">
            <strong>Water–Cement Ratio:</strong>
            <span id="wcRatioValue">0.00</span>
          </div>

          <div id="mixratio-box" class="wc-box" style="display:none;">
            <strong>Mix Ratio:</strong>
            <span id="mixRatioValue">–</span>
          </div>

          <!-- CHEMICAL ADMIXTURES -->
          <h4 class="section-title">Chemical Admixtures / Superplasticizers</h4>

          <div id="admixtures-container" class="dynamic-group"></div>

          <button type="button" id="add-admixture-btn" class="btn-primary small">
            + add admixture/ superplasticizer
          </button>

          <!-- PARTIAL CEMENT REPLACEMENTS -->
          <h4 class="section-title">Partial Cement Replacements (SCMs)</h4>

          <div id="scms-container" class="dynamic-group"></div>

          <button type="button" id="add-scm-btn" class="btn-primary small">
            + add SCM
          </button>

          <!-- ACTIONS AND STATUS -->
          <div class="actions two-cols">
            <button type="submit" id="save-mix-btn" class="btn-submit">
              submit, save &amp; generate PDF
            </button>
            <button type="button" id="reset-form-btn" class="btn-secondary">
              clear form
            </button>
          </div>

          <div id="form-error-summary" class="error-summary"></div>

          <p id="status-line" class="status-pill" style="display: none;"></p>
        </form>
      </section>

      <!-- SAVED MIXES TABLE -->
      <section class="card">
        <h3>Saved Research Mixes</h3>

        <div class="table-actions">
          <button id="export-csv-btn" class="btn-primary small">export CSV</button>
          <button id="clear-all-btn" class="btn-primary small outline">clear all</button>
        </div>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>App No</th>
                <th>Mode</th>
                <th>Student / Researcher</th>
                <th>Type</th>
                <th>W/C</th>
                <th>Saved</th>
              </tr>
            </thead>
            <tbody id="mixes-table-body">
              <tr><td colspan="6" class="no-data">No mixes saved yet.</td></tr>
            </tbody>
          </table>
        </div>
        <p class="subtle small-note">
          Click a row to load that mix back into the form.
        </p>
      </section>
    </div>

    <!-- APPLICATION NUMBER MODAL -->
    <div id="appModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modal-card research">
        <div class="modal-header">
          <h4 id="modalTitle">Application Number</h4>
          <button id="modalClose" type="button" class="modal-x" aria-label="Close dialog">×</button>
        </div>
        <div class="modal-body">
          <div class="modal-number" id="modalNumber">UNILAG-RSH-CLK-A00001</div>
          <div class="modal-actions">
            <button id="modalCopy" type="button" class="btn-primary small">Copy</button>
            <button id="modalOk" type="button" class="btn-secondary">OK</button>
          </div>
          <p class="subtle small-note">Your application number has been generated. Please quote it in all discussions with the Concrete Laboratory.</p>
        </div>
      </div>
    </div>

    <!-- FOOTER -->
    <footer class="footer">
      <p>
        © <span id="year"></span> Designed by Jesuto Ilugbo for The Concrete Laboratory, University of Lagos
      </p>
    </footer>
  </main>
</body>
</html>






